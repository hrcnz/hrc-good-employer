(function(p){var j="addImage_",b=["jpeg","jpg","png"];var t=function(A){var B=this.internal.newObject(),y=this.internal.write,x=this.internal.putStream;A.n=B;y("<</Type /XObject");y("/Subtype /Image");y("/Width "+A.w);y("/Height "+A.h);if(A.cs===this.color_spaces.INDEXED){y("/ColorSpace [/Indexed /DeviceRGB "+(A.pal.length/3-1)+" "+("smask" in A?B+2:B+1)+" 0 R]")}else{y("/ColorSpace /"+A.cs);if(A.cs===this.color_spaces.DEVICE_CMYK){y("/Decode [1 0 1 0 1 0 1 0]")}}y("/BitsPerComponent "+A.bpc);if("f" in A){y("/Filter /"+A.f)}if("dp" in A){y("/DecodeParms <<"+A.dp+">>")}if("trns" in A&&A.trns.constructor==Array){var v="",z=0,C=A.trns.length;for(;z<C;z++){v+=(A.trns[z]+" "+A.trns[z]+" ")}y("/Mask ["+v+"]")}if("smask" in A){y("/SMask "+(B+1)+" 0 R")}y("/Length "+A.data.length+">>");x(A.data);y("endobj");if("smask" in A){var w="/Predictor 15 /Colors 1 /BitsPerComponent "+A.bpc+" /Columns "+A.w;var D={w:A.w,h:A.h,cs:"DeviceGray",bpc:A.bpc,dp:w,data:A.smask};if("f" in A){D.f=A.f}t.call(this,D)}if(A.cs===this.color_spaces.INDEXED){this.internal.newObject();y("<< /Length "+A.pal.length+">>");x(this.arrayBufferToBinaryString(new Uint8Array(A.pal)));y("endobj")}},c=function(){var v=this.internal.collections[j+"images"];for(var w in v){t.call(this,v[w])}},f=function(){var v=this.internal.collections[j+"images"],w=this.internal.write,y;for(var x in v){y=v[x];w("/I"+y.i,y.n,"0","R")}},r=function(v){if(v&&typeof v==="string"){v=v.toUpperCase()}return v in p.image_compression?v:p.image_compression.NONE},g=function(){var v=this.internal.collections[j+"images"];if(!v){this.internal.collections[j+"images"]=v={};this.internal.events.subscribe("putResources",c);this.internal.events.subscribe("putXobjectDict",f)}return v},e=function(w){var v=0;if(w){v=Object.keys?Object.keys(w).length:(function(z){var x=0;for(var y in z){if(z.hasOwnProperty(y)){x++}}return x})(w)}return v},s=function(v){return typeof v==="undefined"||v===null},o=function(v){return undefined},a=function(v){return b.indexOf(v)===-1},i=function(v){return typeof p["process"+v.toUpperCase()]!=="function"},k=function(v){return typeof v==="object"&&v.nodeType===1},u=function(x,y){if(x.nodeName==="IMG"&&x.hasAttribute("src")&&(""+x.getAttribute("src")).indexOf("data:image/")===0){return x.getAttribute("src")}if(x.nodeName==="CANVAS"){var w=x}else{var w=document.createElement("canvas");w.width=x.clientWidth||x.width;w.height=x.clientHeight||x.height;var v=w.getContext("2d");if(!v){throw ("addImage requires canvas to be supported by browser.")}v.drawImage(x,0,0,w.width,w.height)}return w.toDataURL(y=="png"?"image/png":"image/jpeg")},m=function(y,w){var v;if(w){for(var x in w){if(y===w[x].alias){v=w[x];break}}}return v},n=function(v,x,y){if(!v&&!x){v=-96;x=-96}if(v<0){v=(-1)*y.w*72/v/this.internal.scaleFactor}if(x<0){x=(-1)*y.h*72/x/this.internal.scaleFactor}if(v===0){v=x*y.w/y.h}if(x===0){x=v*y.h/y.w}return[v,x]},d=function(F,E,H,z,v,B,C){var G=n.call(this,H,z,v),A=this.internal.getCoordinateString,D=this.internal.getVerticalCoordinateString;H=G[0];z=G[1];C[B]=v;this.internal.write("q",A(H),"0 0",A(z),A(F),D(E+z),"cm /I"+v.i,"Do Q")};p.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPERATION:"Seperation",DEVICE_N:"DeviceN"};p.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};p.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"};p.isString=function(v){return typeof v==="string"};p.extractInfoFromBase64DataURI=function(v){return/^data:([\w]+?\/([\w]+?));base64,(.+?)$/g.exec(v)};p.supportsArrayBuffer=function(){return typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined"};p.isArrayBuffer=function(v){if(!this.supportsArrayBuffer()){return false}return v instanceof ArrayBuffer};p.isArrayBufferView=function(v){if(!this.supportsArrayBuffer()){return false}if(typeof Uint32Array==="undefined"){return false}return(v instanceof Int8Array||v instanceof Uint8Array||(typeof Uint8ClampedArray!=="undefined"&&v instanceof Uint8ClampedArray)||v instanceof Int16Array||v instanceof Uint16Array||v instanceof Int32Array||v instanceof Uint32Array||v instanceof Float32Array||v instanceof Float64Array)};p.binaryStringToUint8Array=function(x){var v=x.length;var w=new Uint8Array(v);for(var y=0;y<v;y++){w[y]=x.charCodeAt(y)}return w};p.arrayBufferToBinaryString=function(w){if(this.isArrayBuffer(w)){w=new Uint8Array(w)}var x="";var v=w.byteLength;for(var y=0;y<v;y++){x+=String.fromCharCode(w[y])}return x};p.arrayBufferToBase64=function(y){var x="";var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var H=new Uint8Array(y);var F=H.byteLength;var w=F%3;var G=F-w;var E,C,B,z;var D;for(var v=0;v<G;v=v+3){D=(H[v]<<16)|(H[v+1]<<8)|H[v+2];E=(D&16515072)>>18;C=(D&258048)>>12;B=(D&4032)>>6;z=D&63;x+=A[E]+A[C]+A[B]+A[z]}if(w==1){D=H[G];E=(D&252)>>2;C=(D&3)<<4;x+=A[E]+A[C]+"=="}else{if(w==2){D=(H[G]<<8)|H[G+1];E=(D&64512)>>10;C=(D&1008)>>4;B=(D&15)<<2;x+=A[E]+A[C]+A[B]+"="}}return x};p.createImageInfo=function(B,z,F,E,v,D,w,C,A,y,G,H){var x={alias:C,w:z,h:F,cs:E,bpc:v,i:w,data:B};if(D){x.f=D}if(A){x.dp=A}if(y){x.trns=y}if(G){x.pal=G}if(H){x.smask=H}return x};p.addImage=function(v,I,H,G,J,C,D,L){if(typeof I==="number"){var B=C;C=J;J=G;G=H;H=I;I=B}var F=g.call(this),E,K;L=r(L);I=(I||"JPEG").toLowerCase();if(s(D)){D=o(v)}if(k(v)){v=u(v,I)}if(this.isString(v)){var M=this.extractInfoFromBase64DataURI(v);if(M){I=M[2];v=atob(M[3]);if(this.supportsArrayBuffer()){K=v;v=this.binaryStringToUint8Array(v)}}else{if(v.charCodeAt(0)!==255){E=m(v,F)}}}if(a(I)){throw new Error("addImage currently only supports formats "+b+", not '"+I+"'")}if(i(I)){throw new Error("please ensure that the plugin for '"+I+"' support is added")}var z=e(F),A=E;if(!A){A=this["process"+I.toUpperCase()](v,z,D,L,K)}if(!A){throw new Error("An unkwown error occurred whilst processing the image")}d.call(this,H,G,J,C,A,z,F);return this};var h=function(A){var z,w;if(!A.charCodeAt(0)===255||!A.charCodeAt(1)===216||!A.charCodeAt(2)===255||!A.charCodeAt(3)===224||!A.charCodeAt(6)==="J".charCodeAt(0)||!A.charCodeAt(7)==="F".charCodeAt(0)||!A.charCodeAt(8)==="I".charCodeAt(0)||!A.charCodeAt(9)==="F".charCodeAt(0)||!A.charCodeAt(10)===0){throw new Error("getJpegSize requires a binary string jpeg file")}var x=A.charCodeAt(4)*256+A.charCodeAt(5);var y=4,v=A.length;while(y<v){y+=x;if(A.charCodeAt(y)!==255){throw new Error("getJpegSize could not find the size of the image")}if(A.charCodeAt(y+1)===192||A.charCodeAt(y+1)===193||A.charCodeAt(y+1)===194||A.charCodeAt(y+1)===195||A.charCodeAt(y+1)===196||A.charCodeAt(y+1)===197||A.charCodeAt(y+1)===198||A.charCodeAt(y+1)===199){w=A.charCodeAt(y+5)*256+A.charCodeAt(y+6);z=A.charCodeAt(y+7)*256+A.charCodeAt(y+8);return[z,w]}else{y+=2;x=A.charCodeAt(y)*256+A.charCodeAt(y+1)}}},q=function(z){var C=(z[0]<<8)|z[1];if(C!==65496){throw new Error("Supplied data is not a JPEG")}var w=z.length,A=(z[4]<<8)+z[5],B=4,x,y,v;while(B<w){B+=A;x=l(z,B);A=(x[2]<<8)+x[3];if((x[1]===192||x[1]===194)&&x[0]===255&&A>7){x=l(z,B+5);y=(x[2]<<8)+x[3];v=(x[0]<<8)+x[1];return{width:y,height:v}}B+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")},l=function(v,w){return v.subarray(w,w+4)};p.processJPEG=function(y,A,z,D,C){var x=this.color_spaces.DEVICE_RGB,w=this.decode.DCT_DECODE,v=8,B;if(this.isString(y)){B=h(y);return this.createImageInfo(y,B[0],B[1],x,v,w,A,z)}if(this.isArrayBuffer(y)){y=new Uint8Array(y)}if(this.isArrayBufferView(y)){B=q(y);y=C||this.arrayBufferToBinaryString(y);return this.createImageInfo(y,B.width,B.height,x,v,w,A,z)}return null};p.processJPG=function(){return this.processJPEG.apply(this,arguments)}})(jsPDF.API);